{"title":"云中的网络安全","date":"2019-06-25T14:49:24.000Z","date_formatted":{"ll":"2019年6月25日","L":"2019/06/25","MM-DD":"06-25"},"link":"2019/06/25/26. 云中的网络安全","tags":["网络协议"],"categories":["网络协议"],"updated":"2019-12-01T15:00:22.149Z","content":"<!-- build time:Sun Aug 23 2020 20:59:40 GMT+0800 (GMT+08:00) --><h2 id=\"公有云网络安全\">公有云网络安全<a href=\"2019/06/25/26. 云中的网络安全#公有云网络安全\"></a></h2><p>对于公有云上的虚拟机，我的建议是仅仅开放需要的端口，而将其他的端口一概关闭。这个时候，你只要通过安全措施守护好这个唯一的入口就可以了。采用的方式常常是用 ACL （Access Control List，访问控制列表）来控制 IP 和端口。</p><ul><li><p>网络包进入一台机器过程</p><p><img src=\"https://static001.geekbang.org/resource/image/a9/fc/a924ccda5d54bcad6f67fdebe0a6c1fc.jpg\" alt=\"img\" class=\"article-img\"></p></li><li><p>内核模块 ip_tables</p><p><img src=\"https://static001.geekbang.org/resource/image/89/fd/897618c5f5b65e8c35ef5f20a731cdfd.jpg\" alt=\"img\" class=\"article-img\"></p><p>conntrack（连接跟踪），filter（数据包过滤），nat（网络地址转换），mangle（数据包修改）</p><p>nat 表主要是处理网络地址转换，可以进行 Snat（改变数据包的源地址）、Dnat（改变数据包的目标地址）</p></li><li><p>表和链表</p><p>iptables 的表分为四种：raw–&gt;mangle–&gt;nat–&gt;filter。这四个优先级依次降低，raw 不常用，所以主要功能都在其他三种表里实现。每个表可以设置多个链。</p><p><img src=\"https://static001.geekbang.org/resource/image/1a/17/1a0ba797b9a0f0e32c9e561b97955917.jpg\" alt=\"img\" class=\"article-img\"></p></li><li><p>云平台安装 iptables 配置</p><p><img src=\"https://static001.geekbang.org/resource/image/93/a3/93aa707cb55c47023ae958d6cadde8a3.jpg\" alt=\"img\" class=\"article-img\"></p><p><img src=\"https://static001.geekbang.org/resource/image/24/24/246db57c915d9ccf6e0d66182de0fe24.jpg\" alt=\"img\" class=\"article-img\"></p><p><img src=\"https://static001.geekbang.org/resource/image/1a/1a/1a5d299c2eb5480eda93a8f8e3b3ca1a.jpg\" alt=\"img\" class=\"article-img\"></p></li></ul><h2 id=\"小结\">小结<a href=\"2019/06/25/26. 云中的网络安全#小结\"></a></h2><ul><li>云中的安全策略的常用方式是，使用 iptables 的规则，请记住它的五个阶段，PREROUTING、INPUT、FORWARD、OUTPUT、POSTROUTING。</li><li>iptables 分为四种表，raw、mangle、nat、filter。其中安全策略主要在 filter 表中实现，而虚拟网络和物理网络地址的转换主要在 nat 表中实现。</li></ul><h2 id=\"思考\">思考<a href=\"2019/06/25/26. 云中的网络安全#思考\"></a></h2><ul><li>这一节中重点讲了 iptables 的 filter 和 nat 功能，iptables 还可以通过 QUEUE 实现负载均衡，你知道怎么做吗？</li><li>这一节仅仅讲述了云中偷窥的问题，如果是一个合法的用户，但是不自觉抢占网络通道，应该采取什么策略呢？</li></ul><!-- rebuild by neat -->","prev":{"title":"CDN","link":"2019/06/25/20. CDN"},"next":{"title":"HTTPS 协议","link":"2019/06/25/15. HTTPS 协议"},"plink":"https://www.jayli.cn/2019/06/25/26. 云中的网络安全/","toc":[{"title":"公有云网络安全","id":"公有云网络安全","index":"1"},{"title":"小结","id":"小结","index":"2"},{"title":"思考","id":"思考","index":"3"}],"copyright":{"link":"<a href=\"https://www.jayli.cn/2019/06/25/26. 云中的网络安全/\" title=\"云中的网络安全\">https://www.jayli.cn/2019/06/25/26. 云中的网络安全/</a>","license":"Attribution-NonCommercial-NoDerivatives 4.0 International (<a href=\\\"https://creativecommons.org/licenses/by-nc-sa/4.0/\\\" rel=\\\"external nofollow\\\" target=\\\"_blank\\\">CC BY-NC-ND 4.0</a>)","published":"2019年6月25日","author":"Jayli"}}