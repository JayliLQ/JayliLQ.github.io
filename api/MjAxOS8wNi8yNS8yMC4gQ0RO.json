{"title":"CDN","date":"2019-06-25T14:49:24.000Z","date_formatted":{"ll":"2019年6月25日","L":"2019/06/25","MM-DD":"06-25"},"link":"2019/06/25/20. CDN","tags":["网络协议"],"categories":["网络协议"],"updated":"2019-12-01T14:58:57.993Z","content":"<!-- build time:Mon Dec 02 2019 23:46:56 GMT+0800 (GMT+08:00) --><h2 id=\"CDN-架构\">CDN 架构<a href=\"2019/06/25/20. CDN#CDN-架构\"></a></h2><p><img src=\"https://static001.geekbang.org/resource/image/d8/cc/d8c77f59d6b7ac894b5192252239cfcc.jpg\" alt=\"\" class=\"article-img\"></p><h2 id=\"客户端如何找到边缘节点\">客户端如何找到边缘节点<a href=\"2019/06/25/20. CDN#客户端如何找到边缘节点\"></a></h2><p><img src=\"https://static001.geekbang.org/resource/image/a9/02/a94d543020d85c8feb9cd665eb4a3502.jpg\" alt=\"\" class=\"article-img\"></p><h2 id=\"CDN-缓存\">CDN 缓存<a href=\"2019/06/25/20. CDN#CDN-缓存\"></a></h2><p><img src=\"https://static001.geekbang.org/resource/image/c8/ac/c81af7a52305f7de27e32e34a02d0eac.jpg\" alt=\"\" class=\"article-img\"></p><p>流媒体 CDN <strong>防盗链</strong>：</p><ul><li>HTTP 头的 refer 字段设置信息</li><li>时间戳防盗链</li></ul><p>客户端取出当前的时间戳，要访问的资源及其路径，连同加密字符串进行签名算法得到一个字符串，然后生成一个下载链接，带上这个签名字符串和截止时间戳去访问 CDN。</p><p>在 CDN 服务端，根据取出过期时间，和当前 CDN 节点时间进行比较，确认请求是否过期。然后 CDN 服务端有了资源及路径，时间戳，以及约定的加密字符串，根据相同的签名算法计算签名，如果匹配则一致，访问合法，才会将资源返回给客户。</p><h2 id=\"动态-CDN-模式\">动态 CDN 模式<a href=\"2019/06/25/20. CDN#动态-CDN-模式\"></a></h2><ul><li>生鲜超市模式，即边缘计算模式</li></ul><p>既然数据是动态生成的，所以数据的逻辑计算和存储，也相应的放在边缘的节点。其中定时从源数据那里同步存储的数据，然后在边缘进行计算得到结果。</p><ul><li>冷链运输模式，即路径优化模式</li></ul><p>数据不是在边缘计算生成的，而是在源站生成的，但是数据的下发则可以通过 CDN 的网络，对路径进行优化。因为 CDN 节点较多，能够找到离源站很近的边缘节点，也能找到离用户很近的边缘节点。中间的链路完全由 CDN 来规划，选择一个更加可靠的路径，使用类似专线的方式进行访问。</p><h2 id=\"小结\">小结<a href=\"2019/06/25/20. CDN#小结\"></a></h2><ul><li>CDN 和电商系统的分布式仓储系统一样，分为中心节点、区域节点、边缘节点，而数据缓存在离用户最近的位置。</li><li>CDN 最擅长的是缓存静态数据，除此之外还可以缓存流媒体数据，这时候要注意使用防盗链。它也支持动态数据的缓存，一种是边缘计算的生鲜超市模式，另一种是链路优化的冷链运输模式。</li></ul><h2 id=\"思考\">思考<a href=\"2019/06/25/20. CDN#思考\"></a></h2><ul><li>这一节讲了 CDN 使用 DNS 进行全局负载均衡的例子，CDN 如何使用 HTTPDNS 呢？</li><li>客户端对 DNS、HTTPDNS、CDN 访问了半天，还没进数据中心，你知道数据中心里面什么样吗？</li></ul><!-- rebuild by neat -->","prev":{"title":"DNS 协议","link":"2019/06/25/18. DNS协议"},"next":{"title":"数据中心","link":"2019/06/25/21. 数据中心"},"plink":"https://www.jayli.cn/2019/06/25/20. CDN/","toc":[{"title":"CDN 架构","id":"CDN-架构","index":"1"},{"title":"客户端如何找到边缘节点","id":"客户端如何找到边缘节点","index":"2"},{"title":"CDN 缓存","id":"CDN-缓存","index":"3"},{"title":"动态 CDN 模式","id":"动态-CDN-模式","index":"4"},{"title":"小结","id":"小结","index":"5"},{"title":"思考","id":"思考","index":"6"}],"copyright":{"link":"<a href=\"https://www.jayli.cn/2019/06/25/20. CDN/\" title=\"CDN\">https://www.jayli.cn/2019/06/25/20. CDN/</a>","license":"Attribution-NonCommercial-NoDerivatives 4.0 International (<a href=\\\"https://creativecommons.org/licenses/by-nc-sa/4.0/\\\" rel=\\\"external nofollow\\\" target=\\\"_blank\\\">CC BY-NC-ND 4.0</a>)","published":"2019年6月25日","author":"Jayli"}}