{"title":"云中网络隔离","date":"2019-06-25T14:49:24.000Z","date_formatted":{"ll":"2019年6月25日","L":"2019/06/25","MM-DD":"06-25"},"link":"2019/06/25/28. 云中网络的隔离GRE、VXLAN","tags":["网络协议"],"categories":["网络协议"],"updated":"2019-12-01T14:55:45.096Z","content":"<!-- build time:Sun Aug 23 2020 21:12:13 GMT+0800 (GMT+08:00) --><h2 id=\"云中网络隔离\">云中网络隔离<a href=\"2019/06/25/28. 云中网络的隔离GRE、VXLAN#云中网络隔离\"></a></h2><p>底层的物理网络设备组成的网络我们称为 Underlay 网络，而用于虚拟机和云中的这些技术组成的网络称为 Overlay 网络，这是一种基于物理网络的虚拟化网络实现。</p><ul><li><p>GRE</p><p>全称 Generic Routing Encapsulation，它是一种 IP-over-IP 的隧道技术。它将 IP 包封装在 GRE 包里，外面加上 IP 头，在隧道的一端封装数据包，并在通路上进行传输，到另外一端的时候解封装。你可以认为 Tunnel 是一个虚拟的、点对点的连接。</p><p>缺点：</p><ul><li><p>GRE 是一种点对点隧道，如果有三个网络，就需要在每两个网络之间建立一个隧道。如果网络数目增多，这样隧道的数目会呈指数性增长。</p></li><li><p>GRE 不支持组播</p></li><li>有很多防火墙和三层网络设备无法解析 GRE，因此它们无法对 GRE 封装包做合适地过滤和负载均衡。</li></ul><p><img src=\"https://static001.geekbang.org/resource/image/b1/31/b189df0a6ee4b0462818bf2f154c9531.jpg\" alt=\"img\" class=\"article-img\"></p><p><img src=\"https://static001.geekbang.org/resource/image/76/ce/76298ce51d349bc9805fbf317312e4ce.jpg\" alt=\"img\" class=\"article-img\"></p></li><li><p>VXLAN</p><p><img src=\"https://static001.geekbang.org/resource/image/3b/0f/3b02d54c9093e3de6d1a847dd0eb060f.jpg\" alt=\"img\" class=\"article-img\"></p><p><img src=\"https://static001.geekbang.org/resource/image/e4/77/e4541dfd1571aab11694343520970a77.jpg\" alt=\"img\" class=\"article-img\"></p><p><img src=\"https://static001.geekbang.org/resource/image/27/79/27b0f23c0e94c10bac63d2ec6401e079.jpg\" alt=\"img\" class=\"article-img\"></p><p><img src=\"https://static001.geekbang.org/resource/image/37/6c/377070660f2474b90489b0f10f8f686c.jpg\" alt=\"img\" class=\"article-img\"></p><p><img src=\"https://static001.geekbang.org/resource/image/5b/6e/5ba8f197a682de2539594ef5d7e7d56e.jpg\" alt=\"img\" class=\"article-img\"></p><p><img src=\"https://static001.geekbang.org/resource/image/b4/19/b4d39cfc833be380be67eeee8019d319.jpg\" alt=\"img\" class=\"article-img\"></p></li><li><p>技术融入云平台</p><p><img src=\"https://static001.geekbang.org/resource/image/8f/4c/8fc4b26b9e42c37adb87db81e36cc64c.jpg\" alt=\"img\" class=\"article-img\"></p><p><img src=\"https://static001.geekbang.org/resource/image/18/cb/184a02e0ee2404b46409cbf3d34837cb.jpg\" alt=\"img\" class=\"article-img\"></p><p><img src=\"https://static001.geekbang.org/resource/image/fc/49/fca6857aaca4f3549b02445ffce71f49.jpg\" alt=\"img\" class=\"article-img\"></p><p><img src=\"https://static001.geekbang.org/resource/image/51/96/5162a39b589901ca3de95de751e90a96.jpg\" alt=\"img\" class=\"article-img\"></p><p><img src=\"https://static001.geekbang.org/resource/image/4d/dd/4dc0fe34819ee02a53a97c89811747dd.jpg\" alt=\"img\" class=\"article-img\"></p></li></ul><h2 id=\"小结\">小结<a href=\"2019/06/25/28. 云中网络的隔离GRE、VXLAN#小结\"></a></h2><ul><li>要对不同用户的网络进行隔离，解决 VLAN 数目有限的问题，需要通过 Overlay 的方式，常用的有 GRE 和 VXLAN。</li><li>GRE 是一种点对点的隧道模式，VXLAN 支持组播的隧道模式，它们都要在某个 Tunnel Endpoint 进行封装和解封装，来实现跨物理机的互通。</li><li>OpenvSwitch 可以作为 Tunnel Endpoint，通过设置流表的规则，将虚拟机网络和物理机网络进行隔离、转换。</li></ul><h2 id=\"思考\">思考<a href=\"2019/06/25/28. 云中网络的隔离GRE、VXLAN#思考\"></a></h2><ul><li>虽然 VXLAN 可以支持组播，但是如果虚拟机数目比较多，在 Overlay 网络里面，广播风暴问题依然会很严重，你能想到什么办法解决这个问题吗？</li><li>基于虚拟机的云比较复杂，而且虚拟机里面的网卡，到物理网络转换层次比较多，有一种比虚拟机更加轻量级的云的模式，你知道是什么吗？</li></ul><!-- rebuild by neat -->","prev":{"title":"云中的网络安全","link":"2019/06/25/26. 云中的网络安全"},"next":{"title":"P2P协议","link":"2019/06/25/P2P协议"},"plink":"https://www.jayli.cn/2019/06/25/28. 云中网络的隔离GRE、VXLAN/","toc":[{"title":"云中网络隔离","id":"云中网络隔离","index":"1"},{"title":"小结","id":"小结","index":"2"},{"title":"思考","id":"思考","index":"3"}],"copyright":{"link":"<a href=\"https://www.jayli.cn/2019/06/25/28. 云中网络的隔离GRE、VXLAN/\" title=\"云中网络隔离\">https://www.jayli.cn/2019/06/25/28. 云中网络的隔离GRE、VXLAN/</a>","license":"Attribution-NonCommercial-NoDerivatives 4.0 International (<a href=\\\"https://creativecommons.org/licenses/by-nc-sa/4.0/\\\" rel=\\\"external nofollow\\\" target=\\\"_blank\\\">CC BY-NC-ND 4.0</a>)","published":"2019年6月25日","author":"Jayli"}}